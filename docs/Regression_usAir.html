<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Marie-Pierre Etienne" />


<title>Régression multiple</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Modélsation statistique</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://github.com/MarieEtienne/ModStat">
    <span class="fa fa-github"></span>
     
    dépôt github
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Présentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-child"></span>
     
    Introduction à R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="intror_presentation.html">Présentation du logiciel R</a>
    </li>
    <li>
      <a href="intror_rstudio.html">Environnement RStudio</a>
    </li>
    <li>
      <a href="intror_manip.html">Manipulation de données</a>
    </li>
    <li>
      <a href="intror_visu.html">Visualisation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-tilde"></span>
     
    Modélisation statistique
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Comp_moyenne.html">Modèle de comparaison de moyennes</a>
    </li>
    <li>
      <a href="anova2.html">Modèle d'analyse de variance</a>
    </li>
    <li>
      <a href="Regression_usAir.html">Modèle de régression linéaire</a>
    </li>
    <li>
      <a href="glm.html">Modèle linéaire généralisé</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Régression multiple</h1>
<h4 class="author">Marie-Pierre Etienne</h4>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(ggfortify)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(sf)</a></code></pre></div>
<pre><code>## Linking to GEOS 3.6.2, GDAL 2.2.3, PROJ 4.9.3</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(maps)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;maps&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     map</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">library</span>(rnaturalearth)</a></code></pre></div>
<div id="presentation" class="section level1">
<h1>Présentation</h1>
<p>Pour étudier la pollution dans des villes américaine, on a mesuré différentes variables. Les valeurs présentées sont les moyennes annuelles des années 1969 à 1971.\ SO2 : Dyoxide de soufre augmente les risques de pluies acides\ temp : temperature \ manuf : nbre de societe employant plus de 20 salariés \ pop : population en milliers \ wind : vitesse moyenne du vent annuel en miles/Heure \ precip hauteur de precipitations annuelles en pouces \ days : nbre de jours de precipitations \</p>
<p>Chargement des données</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">usdata &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/USAIR2.DAT&quot;</span>,</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                     <span class="dt">skip =</span> <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">                     <span class="dt">header =</span> T,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">                     <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">usdata &lt;-<span class="st"> </span>usdata <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">City =</span> <span class="kw">as.character</span>(City)) </a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="kw">head</span>(usdata)</a></code></pre></div>
<pre><code>##            City SO2 temp manuf pop wind precip days
## 1       Phoenix  10 70.3   213 582  6.0   7.05   36
## 2   Little rock  13 61.0    91 132  8.2  48.52  100
## 3 San Francisco  12 56.7   453 716  8.7  20.66   67
## 4        Denver  17 51.9   454 515  9.0  12.95   86
## 5      Hartford  56 49.1   412 158  9.0  43.37  127
## 6    Wilmington  36 54.0    80  80  9.0  40.25  114</code></pre>
<div id="representation-des-villes" class="section level2">
<h2>Representation des villes</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co">##load us.cities </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">data</span>(us.cities)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">nbCity &lt;-<span class="st"> </span><span class="kw">dim</span>(usdata)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw">head</span>(us.cities<span class="op">$</span>name)</a></code></pre></div>
<pre><code>## [1] &quot;Abilene TX&quot; &quot;Akron OH&quot;   &quot;Alameda CA&quot; &quot;Albany GA&quot;  &quot;Albany NY&quot; 
## [6] &quot;Albany OR&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">##indices of studied cities in us.cities</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">ind.cities &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">694</span>, <span class="dv">509</span>, <span class="dv">802</span>, <span class="dv">247</span>, <span class="dv">387</span>, <span class="dv">990</span>, <span class="dv">944</span>, <span class="dv">429</span>, <span class="dv">559</span>, <span class="dv">41</span>,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">                <span class="dv">173</span>, <span class="dv">422</span>, <span class="dv">248</span>, <span class="dv">988</span>, <span class="dv">522</span>, <span class="dv">609</span>, <span class="dv">55</span>, <span class="dv">250</span>, <span class="dv">568</span>, <span class="dv">443</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">                <span class="dv">785</span>, <span class="dv">650</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">126</span>, <span class="dv">180</span>, <span class="dv">185</span>, <span class="dv">195</span>, <span class="dv">693</span>, <span class="dv">700</span>, <span class="dv">726</span>,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">                <span class="dv">549</span>, <span class="dv">601</span>, <span class="dv">225</span>, <span class="dv">413</span>, <span class="dv">794</span>, <span class="dv">619</span>, <span class="dv">753</span>, <span class="dv">834</span>, <span class="dv">165</span>, <span class="dv">567</span>)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"></a>
<a class="sourceLine" id="cb11-7" data-line-number="7">sites &lt;-<span class="st"> </span>us.cities[ind.cities,] </a>
<a class="sourceLine" id="cb11-8" data-line-number="8"></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"></a>
<a class="sourceLine" id="cb11-10" data-line-number="10">sites <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>pop) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">City =</span> <span class="kw">str_replace</span>(name, <span class="dt">pattern =</span>  <span class="st">&quot; [:upper:]+&quot;</span>, <span class="st">&#39;&#39;</span>))  -&gt;<span class="st"> </span>sites</a>
<a class="sourceLine" id="cb11-13" data-line-number="13"></a>
<a class="sourceLine" id="cb11-14" data-line-number="14">usdata &lt;-<span class="st"> </span><span class="kw">inner_join</span>(sites, usdata)</a></code></pre></div>
<pre><code>## Joining, by = &quot;City&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">world &lt;-<span class="st"> </span><span class="kw">ne_countries</span>(<span class="dt">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="dt">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_sf</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> usdata, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat),</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">               <span class="dt">size =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb13-9" data-line-number="9">              <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">fill =</span> <span class="st">&quot;darkred&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="st">    </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">130</span>, <span class="dv">-64</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">22</span>, <span class="dv">50</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Regression_usAir_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
</div>
<div id="description-des-donnees" class="section level1">
<h1>Description des données</h1>
<div id="statistiques-simples-sur-les-donnees" class="section level2">
<h2>Statistiques simples sur les données :</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">usdata <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">summarise_if</span>(is.numeric, mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) </a></code></pre></div>
<pre><code>##        lat      long   capital      SO2   temp    manuf      pop     wind
## 1 38.81321 -87.89321 0.5714286 32.67857 55.075 536.7857 670.1071 9.589286
##     precip     days
## 1 35.80929 117.1071</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">usdata <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">summarise_if</span>(is.numeric, sd, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) </a></code></pre></div>
<pre><code>##        lat     long   capital      SO2     temp    manuf      pop     wind
## 1 4.668694 12.62063 0.9200874 25.84864 7.649237 660.6569 680.2505 1.609541
##     precip     days
## 1 11.72057 29.27689</code></pre>
</div>
<div id="etude-de-la-correlation-entre-les-variables" class="section level2">
<h2>Etude de la corrélation entre les variables :</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">usdata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>name, <span class="op">-</span>country.etc, <span class="op">-</span>capital, <span class="op">-</span>City, <span class="op">-</span>lat, <span class="op">-</span>long) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggpairs</span>()</a></code></pre></div>
<p><img src="Regression_usAir_files/figure-html/reg_correlation-1.png" width="672" /></p>
</div>
<div id="visualisation-de-la-pollution" class="section level2">
<h2>Visualisation de la pollution</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">world &lt;-<span class="st"> </span><span class="kw">ne_countries</span>(<span class="dt">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="dt">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_sf</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> usdata, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">size =</span> <span class="kw">log</span>(SO2)),</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">              <span class="dt">shape =</span> <span class="dv">21</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="st">    </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">130</span>, <span class="dv">-64</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">22</span>, <span class="dv">50</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>)  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;bottom&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>( <span class="dt">size=</span><span class="st">&quot;log(SO2)&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="Regression_usAir_files/figure-html/visua_pol-1.png" alt="The size of the dots depends on the SO2 value and the color as well." width="672" />
<p class="caption">
The size of the dots depends on the SO2 value and the color as well.
</p>
</div>
</div>
<div id="visualisation-du-lien-pollution-et-nombre-dusines" class="section level2">
<h2>Visualisation du lien pollution et nombre d’usines</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">world &lt;-<span class="st"> </span><span class="kw">ne_countries</span>(<span class="dt">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="dt">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_sf</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> usdata, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">fill =</span> manuf, <span class="dt">size =</span> <span class="kw">log</span>(SO2)),</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">              <span class="dt">shape =</span> <span class="dv">21</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="st">    </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">130</span>, <span class="dv">-64</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">22</span>, <span class="dv">50</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>)  <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_viridis_c</span>() <span class="op">+</span><span class="st">     </span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>( <span class="dt">size=</span><span class="st">&quot;log(SO2)&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Nombre d&#39;usines&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="Regression_usAir_files/figure-html/visua_manuf-1.png" alt="The size of the dots depends on the SO2 value and the color on the  manuf variables value." width="672" />
<p class="caption">
The size of the dots depends on the SO2 value and the color on the manuf variables value.
</p>
</div>
</div>
</div>
<div id="regression-lineaire-simple" class="section level1">
<h1>Régression linéaire simple</h1>
<p>##regression SO2 en fonction de manuf</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">usdata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y=</span>SO2, <span class="dt">x =</span>manuf))</a></code></pre></div>
<div class="figure">
<img src="Regression_usAir_files/figure-html/reg_plot1-1.png" alt="Le SO2 en fonction du nombre d'entreprises." width="672" />
<p class="caption">
Le SO2 en fonction du nombre d’entreprises.
</p>
</div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">us.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(SO2 <span class="op">~</span><span class="st"> </span>manuf, <span class="dt">data =</span> usdata)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw">model.matrix</span>(us.lm)</a></code></pre></div>
<pre><code>##    (Intercept) manuf
## 1            1   213
## 2            1   454
## 3            1   412
## 4            1    80
## 5            1   207
## 6            1   368
## 7            1  3344
## 8            1   125
## 9            1   291
## 10           1   625
## 11           1  1064
## 12           1   699
## 13           1   181
## 14           1    46
## 15           1    44
## 16           1   391
## 17           1   462
## 18           1  1007
## 19           1   266
## 20           1  1692
## 21           1   343
## 22           1   275
## 23           1   641
## 24           1   721
## 25           1    96
## 26           1   379
## 27           1    35
## 28           1   569
## attr(,&quot;assign&quot;)
## [1] 0 1</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">summary</span>(us.lm)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = SO2 ~ manuf, data = usdata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -27.422 -13.679  -6.043  10.064  66.311 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 18.857158   4.864747   3.876 0.000645 ***
## manuf        0.025748   0.005777   4.457 0.000141 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.83 on 26 degrees of freedom
## Multiple R-squared:  0.4331, Adjusted R-squared:  0.4113 
## F-statistic: 19.86 on 1 and 26 DF,  p-value: 0.000141</code></pre>
<p>Comparaison modèle nul et modèle incluant le nombre d’usines</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">lm0 &lt;-<span class="st"> </span><span class="kw">lm</span>(SO2 <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> usdata)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw">anova</span>(lm0, us.lm)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: SO2 ~ 1
## Model 2: SO2 ~ manuf
##   Res.Df   RSS Df Sum of Sq      F   Pr(&gt;F)    
## 1     27 18040                                 
## 2     26 10227  1      7813 19.863 0.000141 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Valeur des paramètres estimés et tests sur les paramètres :</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">summary</span>(us.lm)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = SO2 ~ manuf, data = usdata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -27.422 -13.679  -6.043  10.064  66.311 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 18.857158   4.864747   3.876 0.000645 ***
## manuf        0.025748   0.005777   4.457 0.000141 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.83 on 26 degrees of freedom
## Multiple R-squared:  0.4331, Adjusted R-squared:  0.4113 
## F-statistic: 19.86 on 1 and 26 DF,  p-value: 0.000141</code></pre>
<div id="effet-levier-des-differents-individus" class="section level2">
<h2>Effet levier des différents individus</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">autoplot</span>(us.lm)</a></code></pre></div>
<p><img src="Regression_usAir_files/figure-html/leverage-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"> h.us.lm &lt;-<span class="st"> </span><span class="kw">hatvalues</span>(us.lm)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2"> <span class="kw">sum</span>(h.us.lm)</a></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"> <span class="kw">sum</span>(h.us.lm)<span class="op">/</span><span class="kw">length</span>(usdata<span class="op">$</span>SO2)</a></code></pre></div>
<pre><code>## [1] 0.07142857</code></pre>
<p>Graphiques de diagnostics</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">autoplot</span>(us.lm, <span class="dt">data =</span> usdata)</a></code></pre></div>
<div class="figure">
<img src="Regression_usAir_files/figure-html/reg_simp_diag-1.png" alt="Les différents graphiques de diagnostic fournis par R" width="672" />
<p class="caption">
Les différents graphiques de diagnostic fournis par R
</p>
</div>
<p>Effet de la ville de chicago</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">usdata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">rownames</span>(usdata)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(id <span class="op">!=</span><span class="st"> &#39;Chicago&#39;</span>) -&gt;<span class="st"> </span>usdata_sans_chicago</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">lm_sans_chicago &lt;-<span class="st"> </span><span class="kw">lm</span>(SO2 <span class="op">~</span><span class="st"> </span>manuf , <span class="dt">data =</span> usdata_sans_chicago)</a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="kw">summary</span>(lm_sans_chicago)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = SO2 ~ manuf, data = usdata_sans_chicago)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -27.422 -13.679  -6.043  10.064  66.311 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 18.857158   4.864747   3.876 0.000645 ***
## manuf        0.025748   0.005777   4.457 0.000141 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.83 on 26 degrees of freedom
## Multiple R-squared:  0.4331, Adjusted R-squared:  0.4113 
## F-statistic: 19.86 on 1 and 26 DF,  p-value: 0.000141</code></pre>
</div>
</div>
<div id="regression-multiple" class="section level1">
<h1>Régression multiple</h1>
<p>Mise en oeuvre de la régression multiple :</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">us.lm2 &lt;-<span class="st"> </span><span class="kw">lm</span>(SO2 <span class="op">~</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span>manuf <span class="op">+</span><span class="st"> </span>wind <span class="op">+</span><span class="st"> </span>precip <span class="op">+</span><span class="st"> </span>days, <span class="dt">data =</span> usdata)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="co">## test de type I</span></a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="kw">anova</span>(us.lm2)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: SO2
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## temp       1 2939.4  2939.4 10.5638  0.00367 ** 
## manuf      1 6417.5  6417.5 23.0635 8.51e-05 ***
## wind       1  529.0   529.0  1.9010  0.18182    
## precip     1 1361.2  1361.2  4.8919  0.03767 *  
## days       1  671.4   671.4  2.4128  0.13461    
## Residuals 22 6121.6   278.3                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co">## test de type II</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="kw">Anova</span>(us.lm2, <span class="dt">type=</span><span class="st">&quot;II&quot;</span>)</a></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: SO2
##           Sum Sq Df F value    Pr(&gt;F)    
## temp      2739.4  1  9.8449  0.004784 ** 
## manuf     6730.1  1 24.1867 6.427e-05 ***
## wind      1077.8  1  3.8734  0.061787 .  
## precip    1807.1  1  6.4944  0.018317 *  
## days       671.4  1  2.4128  0.134613    
## Residuals 6121.6 22                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">autoplot</span>(us.lm2, <span class="dt">data =</span> usdata)</a></code></pre></div>
<p><img src="Regression_usAir_files/figure-html/reg_mult_res-1.png" width="672" /></p>
<p>Les valeurs estimées des paramètres</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">summary</span>(us.lm2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = SO2 ~ temp + manuf + wind + precip + days, data = usdata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.058  -8.758  -1.047   4.467  52.507 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 185.97504   60.38787   3.080  0.00548 ** 
## temp         -2.35969    0.75206  -3.138  0.00478 ** 
## manuf         0.02469    0.00502   4.918 6.43e-05 ***
## wind         -4.31314    2.19153  -1.968  0.06179 .  
## precip        1.25036    0.49064   2.548  0.01832 *  
## days         -0.34159    0.21990  -1.553  0.13461    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 16.68 on 22 degrees of freedom
## Multiple R-squared:  0.6607, Adjusted R-squared:  0.5835 
## F-statistic: 8.567 on 5 and 22 DF,  p-value: 0.0001267</code></pre>
</div>
<div id="selection-automatique-de-variables" class="section level1">
<h1>Sélection automatique de variables</h1>
<p>Sélection de variables backward : {</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">stepus.back &lt;-<span class="st"> </span><span class="kw">step</span>(us.lm2, <span class="dt">direction =</span> <span class="st">&quot;backward&quot;</span>)</a></code></pre></div>
<pre><code>## Start:  AIC=162.85
## SO2 ~ temp + manuf + wind + precip + days
## 
##          Df Sum of Sq     RSS    AIC
## &lt;none&gt;                 6121.6 162.85
## - days    1     671.4  6793.0 163.76
## - wind    1    1077.8  7199.4 165.39
## - precip  1    1807.1  7928.7 168.09
## - temp    1    2739.4  8861.0 171.20
## - manuf   1    6730.1 12851.7 181.61</code></pre>
<p>Sélection de variables forward :</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">stepus.forward &lt;-<span class="st"> </span><span class="kw">step</span>(<span class="kw">lm</span>(SO2<span class="op">~</span><span class="dv">1</span>,<span class="dt">data=</span>usdata), <span class="dt">scope=</span><span class="op">~</span>temp<span class="op">+</span>pop<span class="op">+</span>manuf<span class="op">+</span>wind<span class="op">+</span>precip<span class="op">+</span>days</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">, <span class="dt">direction=</span><span class="st">&quot;forward&quot;</span>)</a></code></pre></div>
<pre><code>## Start:  AIC=183.11
## SO2 ~ 1
## 
##          Df Sum of Sq   RSS    AIC
## + manuf   1    7813.0 10227 169.22
## + pop     1    4817.1 13223 176.41
## + temp    1    2939.4 15101 180.13
## + days    1    1827.9 16212 182.12
## &lt;none&gt;                18040 183.11
## + precip  1     594.1 17446 184.17
## + wind    1      65.3 17975 185.01
## 
## Step:  AIC=169.22
## SO2 ~ manuf
## 
##          Df Sum of Sq     RSS    AIC
## + pop     1    3597.9  6629.2 159.08
## + temp    1    1543.9  8683.2 166.63
## + days    1    1075.5  9151.5 168.10
## &lt;none&gt;                10227.1 169.22
## + precip  1     534.2  9692.8 169.71
## + wind    1     136.1 10091.0 170.84
## 
## Step:  AIC=159.08
## SO2 ~ manuf + pop
## 
##          Df Sum of Sq    RSS    AIC
## &lt;none&gt;                6629.2 159.08
## + precip  1    302.95 6326.3 159.77
## + wind    1    232.01 6397.2 160.08
## + temp    1    192.62 6436.6 160.25
## + days    1    106.51 6522.7 160.62</code></pre>
<p>Sélection de variables stepwise :</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">stepus.stepwise &lt;-<span class="st"> </span><span class="kw">step</span>(us.lm2, <span class="dt">direction=</span><span class="st">&quot;both&quot;</span>)</a></code></pre></div>
<pre><code>## Start:  AIC=162.85
## SO2 ~ temp + manuf + wind + precip + days
## 
##          Df Sum of Sq     RSS    AIC
## &lt;none&gt;                 6121.6 162.85
## - days    1     671.4  6793.0 163.76
## - wind    1    1077.8  7199.4 165.39
## - precip  1    1807.1  7928.7 168.09
## - temp    1    2739.4  8861.0 171.20
## - manuf   1    6730.1 12851.7 181.61</code></pre>
<p>Test sur le modèle sélectionné par la procédure</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">lm_select &lt;-<span class="st"> </span><span class="kw">lm</span>(SO2 <span class="op">~</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span>manuf <span class="op">+</span><span class="st"> </span>pop <span class="op">+</span><span class="st"> </span>wind <span class="op">+</span><span class="st"> </span>precip, <span class="dt">data =</span> usdata)</a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="kw">summary</span>(lm_select)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = SO2 ~ temp + manuf + pop + wind + precip, data = usdata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -24.568  -9.877  -0.007   4.942  47.822 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 84.56908   35.16231   2.405  0.02502 * 
## temp        -0.84103    0.49267  -1.707  0.10188   
## manuf        0.07234    0.02013   3.594  0.00161 **
## pop         -0.04709    0.01931  -2.439  0.02327 * 
## wind        -3.07932    2.01586  -1.528  0.14088   
## precip       0.46595    0.27440   1.698  0.10359   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 15.59 on 22 degrees of freedom
## Multiple R-squared:  0.7036, Adjusted R-squared:  0.6362 
## F-statistic: 10.44 on 5 and 22 DF,  p-value: 3.111e-05</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">lm_select &lt;-<span class="st"> </span><span class="kw">lm</span>(SO2 <span class="op">~</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span>manuf <span class="op">+</span><span class="st"> </span>pop <span class="op">+</span><span class="st"> </span>precip, <span class="dt">data =</span> usdata)</a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="kw">summary</span>(lm_select)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = SO2 ~ temp + manuf + pop + precip, data = usdata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -26.241 -10.353  -0.657   6.450  45.185 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 45.87841   25.08654   1.829  0.08043 . 
## temp        -0.61030    0.48234  -1.265  0.21844   
## manuf        0.07433    0.02066   3.598  0.00152 **
## pop         -0.05028    0.01975  -2.546  0.01806 * 
## precip       0.39658    0.27835   1.425  0.16765   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 16.04 on 23 degrees of freedom
## Multiple R-squared:  0.6721, Adjusted R-squared:  0.6151 
## F-statistic: 11.79 on 4 and 23 DF,  p-value: 2.352e-05</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">lm_select &lt;-<span class="st"> </span><span class="kw">lm</span>(SO2 <span class="op">~</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span>manuf <span class="op">+</span><span class="st"> </span>pop , <span class="dt">data =</span> usdata)</a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw">summary</span>(lm_select)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = SO2 ~ temp + manuf + pop, data = usdata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -24.746 -10.357  -0.267   6.538  47.182 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 48.92559   25.52591   1.917  0.06726 .  
## temp        -0.39680    0.46821  -0.847  0.40510    
## manuf        0.08133    0.02049   3.969  0.00057 ***
## pop         -0.05678    0.01962  -2.894  0.00797 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 16.38 on 24 degrees of freedom
## Multiple R-squared:  0.6432, Adjusted R-squared:  0.5986 
## F-statistic: 14.42 on 3 and 24 DF,  p-value: 1.404e-05</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">lm_select &lt;-<span class="st"> </span><span class="kw">lm</span>(SO2 <span class="op">~</span><span class="st"> </span>manuf <span class="op">+</span><span class="st"> </span>pop , <span class="dt">data =</span> usdata)</a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="kw">summary</span>(lm_select)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = SO2 ~ manuf + pop, data = usdata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -21.929 -13.158  -1.843   9.222  47.126 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 27.65985    4.65455   5.943 3.34e-06 ***
## manuf        0.08954    0.01796   4.987 3.86e-05 ***
## pop         -0.06424    0.01744  -3.684  0.00111 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 16.28 on 25 degrees of freedom
## Multiple R-squared:  0.6325, Adjusted R-squared:  0.6031 
## F-statistic: 21.52 on 2 and 25 DF,  p-value: 3.675e-06</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
